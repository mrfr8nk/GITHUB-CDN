<!-- public/index.html -->
<!DOCTYPE html>
<html>
<head>
  <title>GitCDN - GitHub File Hosting</title>
  <style>
    body { font-family: Arial, sans-serif; max-width: 800px; margin: 0 auto; padding: 20px; }
    .upload-box { border: 2px dashed #ccc; padding: 30px; text-align: center; margin: 20px 0; }
    #preview { max-width: 100%; margin-top: 20px; }
    #result { margin-top: 20px; padding: 15px; background: #f5f5f5; }
  </style>
</head>
<body>
  <h1>GitCDN</h1>
  <p>Upload files to GitHub with direct CDN links</p>
  
  <div class="upload-box">
    <input type="file" id="fileInput">
    <button onclick="uploadFile()">Upload File</button>
    <div id="preview"></div>
  </div>

  <div id="result" style="display:none;">
    <h3>Your file URL:</h3>
    <input type="text" id="fileUrl" style="width:100%; padding:10px;" readonly>
    <button onclick="copyUrl()">Copy URL</button>
  </div>

  <script>
    function uploadFile() {
      const fileInput = document.getElementById('fileInput');
      const file = fileInput.files[0];
      
      if (!file) return alert('Please select a file');
      
      // Show preview
      if (file.type.startsWith('image/')) {
        const reader = new FileReader();
        reader.onload = (e) => {
          document.getElementById('preview').innerHTML = `
            <img src="${e.target.result}" style="max-height:200px;">
            <p>${file.name} (${formatBytes(file.size)})</p>
          `;
        };
        reader.readAsDataURL(file);
      }

      // Upload to server
      const formData = new FormData();
      formData.append('file', file);

      fetch('/upload', {
        method: 'POST',
        body: formData
      })
      .then(res => res.json())
      .then(data => {
        document.getElementById('fileUrl').value = data.url;
        document.getElementById('result').style.display = 'block';
      })
      .catch(err => {
        console.error(err);
        alert('Upload failed');
      });
    }

    function copyUrl() {
      const urlInput = document.getElementById('fileUrl');
      urlInput.select();
      document.execCommand('copy');
      alert('URL copied to clipboard!');
    }

    function formatBytes(bytes) {
      if (bytes === 0) return '0 Bytes';
      const k = 1024;
      const sizes = ['Bytes', 'KB', 'MB', 'GB'];
      const i = Math.floor(Math.log(bytes) / Math.log(k));
      return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];
    }
  </script>
</body>
</html>
